# 【成果物1/3】 README.md

# 点検報告書 旧データ移行ツール README

## 1. 概要 (Overview)

本ツールは、Excelで管理されている旧バージョンの点検報告書から、指定されたデータを抽出し、新しいバージョンの点検報告書（テンプレートファイルがベース）へ自動的に転記、作成するためのVBAマクロツールです。

従来の手作業によるコピー＆ペースト作業を自動化することで、以下の効果を目指します。
- **作業時間の大幅な短縮**
- **転記ミスや削除漏れなどのヒューマンエラーの撲滅**
- **誰が実行しても同じ品質の成果物を担保**

## 2. 特徴 (Features)

- **設定シートによる柔軟な操作:** コピー元、コピー先、削除箇所などの一連の操作は、すべて「Settings」シートで定義します。これにより、VBAコードを直接編集することなく、将来的な仕様変更にも柔軟に対応可能です。
- **テンプレートベースの新規ファイル作成:** 固定のテンプレートファイルを元に新しい報告書を作成するため、常に正しいフォーマットのファイルが生成されます。
- **動的なテンプレート選択機能:** 旧データの特定セルの値を元に、使用すべきテンプレートファイルを「List」シートから自動的に検索し、選択します。
- **堅牢なエラーハンドリング:** 処理中にエラーが発生しても（例：指定シートが存在しない）、処理は中断されません。エラー内容は「Error」シートに記録され、後から確認できます。
- **詳細な処理ログ:** 実行されたすべての処理ステップは「Log」シートに記録され、処理の透明性を確保し、デバッグや監査証跡として利用できます。

## 3. 前提条件 (Prerequisites)

- **対応ソフトウェア:** Microsoft Excel 2021 / Microsoft 365
  - `TEXTAFTER`などのモダンなExcel関数を使用するため、古いバージョンでは一部機能が動作しない可能性があります。
- **マクロの有効化:** 本ツールはVBAマクロを使用しているため、実行前にマクロを有効にする必要があります。
- **ファイルパス:** 本ツールや関連ファイル（旧ブック、テンプレート）は、PCのローカルドライブまたはアクセス可能なネットワークドライブに配置されている必要があります。

## 4. ファイル構成とシートの役割

本ツールは、以下のシートを含む単一のExcelファイル（`.xlsm`形式）で構成されます。

- `Macro-Tool.xlsm` (本ツールのファイル名例)
  - `Control`シート: マクロの実行ボタンを配置する、ユーザーが最初に開く操作画面です。
  - `Settings`シート: データ移行のルールを定義する設定シートです。ユーザーが主に編集します。
  - `List`シート: 報告書の種類と、それに対応するテンプレートファイルのパスを管理するマスタリストです。
  - `Log`シート: マクロの実行履歴を記録するシートです。実行時に自動的にクリアされ、新しいログが追記されます。
  - `Error`シート: 処理中に発生したエラーを記録するシートです。実行時に自動的にクリアされ、エラー発生時に追記されます。

## 5. 使い方 (Quick Start)

1.  **本ツールを開く:** `Macro-Tool.xlsm` を開きます。
2.  **`List`シートの確認/更新:**
    - 新しい種類の報告書やテンプレートがある場合、「List」シートに情報を追記・更新します。
3.  **`Settings`シートの設定:**
    - `D2`セルに、**データ移行元となる「旧ブック」のフルパス**を入力します。
    - `D3`セルに、**新ブックの種類を判断するための値が記載されている、旧ブックのアドレス**（例: `'87'!T7:AB7`）を入力します。
    - `D5`セル以降のファイル名分割情報が、数式により自動で更新されることを確認します。
    - `A16`行以降の処理内容（コピー、削除、入力のルール）が正しく設定されていることを確認します。
4.  **マクロの実行:**
    - `Control`シートに移動し、**「処理実行」ボタン**をクリックします。
5.  **結果の確認:**
    - 処理が完了すると、メッセージボックスで通知されます。
    - `Settings`シートの`D10`セルに指定されたパスに、新しいブックが作成されていることを確認します。
    - 意図しない動作があった場合は、まず`Error`シートを確認し、次に`Log`シートで詳細な処理の流れを確認してください。

## 6. バージョン履歴 (Version History)

- v1.0.0 (2025-07-05): 初版リリース